<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Mario-Style Game</title>
<style>
    body { 
        margin: 0; 
        padding: 0;
        overflow: hidden; 
        background-color: #d3d3d3; 
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
    }
    #gameContainer { 
        position: relative; 
        width: 100vw; 
        height: 100vh; 
        overflow: hidden; 
        background-image: url('../t2a25/BackgroundImg.png'); 
        background-repeat: repeat-x;
        background-size: auto 100%;
        background-color: #87ceeb;
    }
    img { position: absolute; }
    #ui { 
        position: absolute; 
        top: 0; 
        left: 0; 
        padding: 20px; 
        color: #fff; 
        font-family: sans-serif; 
        font-weight: bold;
        text-shadow: 2px 2px #000;
        z-index: 1000; 
    }
    #message { 
        position: absolute; 
        top: 40%; 
        left: 50%; 
        transform: translate(-50%, -50%); 
        font-size: 32px; 
        color: #fff; 
        background: rgba(0,0,0,0.8); 
        padding: 20px 40px; 
        border-radius: 10px; 
        display: none; 
        z-index: 1001; 
    }
</style>
</head>
<body>

<div id="gameContainer">
  <div id="ui">Lives: 3 | Score: 0</div>
  <div id="message"></div>

  <img id="player" src="../t2a25/MoveImg.png" style="width:50px; height:50px; top:300px; left:50px;">
  <img id="hazard1" src="../t2a25/StillImg.png" style="width:50px; height:50px; top:350px; left:300px;">
  <img id="hazard2" src="../t2a25/StillImg.png" style="width:50px; height:50px; top:350px; left:500px;">
  <img id="ground" src="../t2a25/GroundImg.png" style="width:5000px; height:50px; top:90%; left:0;">
  <img id="platform1" src="../t2a25/GroundImg.png" style="width:150px; height:30px; top:70%; left:300px;">
  <img id="platform2" src="../t2a25/GroundImg.png" style="width:150px; height:30px; top:55%; left:600px;">
  <img id="platform3" src="../t2a25/GroundImg.png" style="width:150px; height:30px; top:40%; left:900px;">
  <img id="goal" src="https://placehold.co/50x50/00FF00/FFFFFF?text=FLAG" style="width:60px; height:80px; top:80%; left:4800px;">
</div>

<script>
class GameObject {
    constructor(id, x, y, width, height) {
        this.id = id;
        this.el = document.getElementById(id);
        this.x = x; this.y = y;
        this.width = width; this.height = height;
        this.vx = 0; this.vy = 0;
        this.updatePosition();
    }
    updatePosition() { 
        this.el.style.left = this.x + 'px'; 
        this.el.style.top = this.y + 'px'; 
    }
    collidesWith(other) { 
        return !(this.x + this.width <= other.x || 
                 this.x >= other.x + other.width || 
                 this.y + this.height <= other.y || 
                 this.y >= other.y + other.height); 
    }
}

class Player extends GameObject {
    constructor(id, x, y, width, height) { super(id,x,y,width,height); this.onGround=false; }
    move() { this.x += this.vx; this.y += this.vy; }
}

class Hazard extends GameObject {
    constructor(id, x, y, width, height) { super(id,x,y,width,height); this.vx=2; }
    move() { this.x += this.vx; this.y += this.vy; }
}

class Ground extends GameObject {}
class Platform extends GameObject {}
class Goal extends GameObject {}

const player = new Player('player',100,100,50,50);
const hazards = [
    new Hazard('hazard1',600,300,50,50),
    new Hazard('hazard2',1200,300,50,50)
];

const grounds = [ new Ground('ground',0,window.innerHeight * 0.9, 5000, 100) ];
const platforms = [
    new Platform('platform1',400, window.innerHeight * 0.7, 150, 30),
    new Platform('platform2',800, window.innerHeight * 0.55, 150, 30),
    new Platform('platform3',1200, window.innerHeight * 0.4, 150, 30)
];
const goal = new Goal('goal',4800, window.innerHeight * 0.8, 60, 80);

const keys = {};
document.addEventListener('keydown', e => keys[e.key.toLowerCase()]=true);
document.addEventListener('keyup', e => keys[e.key.toLowerCase()]=false);

const gravity=0.8, moveSpeed=7, jumpPower=-18;
const messageDiv = document.getElementById('message');
const container = document.getElementById('gameContainer');

function showMessage(text, duration=1500){
    messageDiv.innerText = text;
    messageDiv.style.display = 'block';
    setTimeout(()=>{ messageDiv.style.display='none'; }, duration);
}

function checkCollision(obj) {
    obj.onGround = false;
    const targets = grounds.concat(platforms);
    for(let p of targets){
        if(obj.y + obj.height <= p.y &&
           obj.y + obj.height + obj.vy >= p.y &&
           obj.x + obj.width > p.x &&
           obj.x < p.x + p.width){
            obj.y = p.y - obj.height;
            obj.vy = 0;
            obj.onGround = true;
        }
    }
}

function updateHazards(){
    for(let h of hazards){
        h.vy += gravity;
        checkCollision(h);
        h.move();
        if(h.x <= 0 || h.x >= 4950) h.vx *= -1;
        h.updatePosition();
    }
}

function gameLoop(){
    player.vx=0;
    if(keys['a'] || keys['arrowleft']) player.vx=-moveSpeed;
    if(keys['d'] || keys['arrowright']) player.vx=moveSpeed;
    if((keys['w'] || keys[' ']) && player.onGround) player.vy=jumpPower;

    player.vy += gravity;
    checkCollision(player);
    player.move();

    updateHazards();
    
    for(let h of hazards){
        if(player.collidesWith(h)){
            showMessage('Hit Hazard!');
            player.x = 100; player.y = 100;
        }
    }

    if(player.collidesWith(goal)){
        showMessage('YOU WIN!', 5000);
        return;
    }

    const screenMid = window.innerWidth / 2;
    const offset = Math.max(player.x - screenMid, 0);

    [...hazards, ...platforms, ...grounds, goal].forEach(obj => { 
        obj.el.style.left = (obj.x - offset) + 'px'; 
    });

    player.el.style.left = (player.x < screenMid) ? player.x + 'px' : screenMid + 'px';
    player.el.style.top = player.y + 'px';

    container.style.backgroundPosition = -(offset * 0.5) + "px 0px";

    requestAnimationFrame(gameLoop);
}

gameLoop();
</script>
</body>
</html>