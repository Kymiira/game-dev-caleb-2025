<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Refined Side-Scroller</title>
<style>
    :root {
        --sky-blue: #87ceeb;
        --ground-brown: #8B4513;
        --platform-green: #2ecc71;
    }
    body, html { 
        margin: 0; 
        padding: 0; 
        width: 100%; 
        height: 100%; 
        overflow: hidden; 
        background-color: #2c3e50; 
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    #gameContainer { 
        position: relative; 
        width: 100vw; 
        height: 100vh; 
        background-image: url('../t2a25/BackgroundImg.png'); 
        background-repeat: repeat-x;
        background-size: auto 100%;
        background-color: var(--sky-blue);
        box-shadow: inset 0 0 100px rgba(0,0,0,0.2);
    }
    .entity { position: absolute; border-radius: 4px; transition: transform 0.1s; }
    #player { 
        z-index: 10; 
        filter: drop-shadow(2px 4px 6px rgba(0,0,0,0.3));
    }
    .hazard { 
        background: #e74c3c; 
        border: 3px solid #c0392b;
        box-shadow: 0 4px 0 #922b21;
    }
    .platform { 
        background: var(--platform-green); 
        border-bottom: 5px solid #27ae60;
        border-radius: 8px;
    }
    #ground { 
        background: var(--ground-brown); 
        border-top: 6px solid #5d2e0a;
    }
    #ui { 
        position: absolute; 
        top: 20px; 
        left: 20px; 
        padding: 15px 25px; 
        color: #fff; 
        background: rgba(0,0,0,0.5);
        border-radius: 50px;
        font-weight: bold;
        backdrop-filter: blur(5px);
        z-index: 1000; 
    }
    #message { 
        position: absolute; 
        top: 50%; 
        left: 50%; 
        transform: translate(-50%, -50%); 
        font-size: 40px; 
        color: #fff; 
        background: rgba(0,0,0,0.85); 
        padding: 30px 60px; 
        border-radius: 15px; 
        display: none; 
        z-index: 1001; 
        text-align: center;
        border: 4px solid #fff;
    }
</style>
</head>
<body>

<div id="gameContainer" id="viewport">
  <div id="ui">Score: <span id="scoreVal">0</span></div>
  <div id="message"></div>

  <img id="player" src="../t2a25/MoveImg.png" class="entity" style="width:50px; height:50px;">
  
  <div id="hazard1" class="entity hazard" style="width:40px; height:40px;"></div>
  <div id="hazard2" class="entity hazard" style="width:40px; height:40px;"></div>

  <div id="platform1" class="entity platform" style="width:200px; height:30px;"></div>
  <div id="platform2" class="entity platform" style="width:200px; height:30px;"></div>
  <div id="platform3" class="entity platform" style="width:200px; height:30px;"></div>

  <div id="ground" class="entity" style="width:100%; height:100px;"></div>
  
  <img id="goal" src="https://placehold.co/60x80/00FF00/FFFFFF?text=ðŸ" class="entity" style="width:60px; height:80px;">
</div>

<script>
let score = 0;
let bgPos = 0;
const container = document.getElementById('gameContainer');

class GameObject {
    constructor(id, x, y, width, height) {
        this.el = document.getElementById(id);
        this.x = x; this.y = y;
        this.width = width; this.height = height;
        this.vx = 0; this.vy = 0;
    }
    updatePosition() { 
        this.el.style.left = this.x + 'px'; 
        this.el.style.top = this.y + 'px'; 
    }
    collidesWith(other) { 
        return !(this.x + this.width <= other.x || this.x >= other.x + other.width || 
                 this.y + this.height <= other.y || this.y >= other.y + other.height); 
    }
}

const player = new GameObject('player', 100, 100, 50, 50);
const hazards = [
    new GameObject('hazard1', 600, 0, 40, 40),
    new GameObject('hazard2', 1100, 0, 40, 40)
];
hazards[0].vx = 3; hazards[1].vx = -3;

const groundHeight = 80;
const grounds = [new GameObject('ground', 0, window.innerHeight - groundHeight, window.innerWidth, groundHeight)];
const platforms = [
    new GameObject('platform1', 300, window.innerHeight * 0.7, 200, 30),
    new GameObject('platform2', 700, window.innerHeight * 0.5, 200, 30),
    new GameObject('platform3', 1100, window.innerHeight * 0.3, 200, 30)
];
const goal = new GameObject('goal', window.innerWidth - 100, window.innerHeight - groundHeight - 80, 60, 80);

const keys = {};
window.addEventListener('keydown', e => keys[e.key.toLowerCase()] = true);
window.addEventListener('keyup', e => keys[e.key.toLowerCase()] = false);

const gravity = 0.8;
const moveSpeed = 8;
const jumpPower = -18;

function showMessage(text) {
    const m = document.getElementById('message');
    m.innerHTML = text + "<br><span style='font-size:18px'>Press R to Restart</span>";
    m.style.display = 'block';
}

function checkPhysics(obj) {
    obj.onGround = false;
    const collidables = [...grounds, ...platforms];
    collidables.forEach(p => {
        if (obj.y + obj.height <= p.y && obj.y + obj.height + obj.vy >= p.y &&
            obj.x + obj.width > p.x && obj.x < p.x + p.width) {
            obj.y = p.y - obj.height;
            obj.vy = 0;
            obj.onGround = true;
        }
    });
}

function gameLoop() {
    if (keys['r']) location.reload();

    // Constant Background Move
    bgPos -= 2; 
    container.style.backgroundPosition = bgPos + "px 0px";

    // Player Input
    player.vx = 0;
    if (keys['a'] || keys['arrowleft']) player.vx = -moveSpeed;
    if (keys['d'] || keys['arrowright']) player.vx = moveSpeed;
    if ((keys['w'] || keys[' ']) && player.onGround) player.vy = jumpPower;

    // Apply Physics
    player.vy += gravity;
    checkPhysics(player);
    player.x += player.vx;
    player.y += player.vy;

    // Stay inside monitor window
    if (player.x < 0) player.x = 0;
    if (player.x + player.width > window.innerWidth) player.x = window.innerWidth - player.width;

    player.updatePosition();

    // Hazards
    hazards.forEach(h => {
        h.vy += gravity;
        checkPhysics(h);
        h.x += h.vx;
        if (h.x <= 0 || h.x + h.width >= window.innerWidth) h.vx *= -1;
        h.updatePosition();
        if (player.collidesWith(h)) {
            showMessage("GAME OVER");
            return;
        }
    });

    // Goal
    goal.updatePosition();
    if (player.collidesWith(goal)) {
        showMessage("LEVEL CLEAR!");
        return;
    }

    requestAnimationFrame(gameLoop);
}

// Handle window resize dynamically
window.addEventListener('resize', () => {
    grounds[0].y = window.innerHeight - groundHeight;
    grounds[0].width = window.innerWidth;
    grounds[0].updatePosition();
});

gameLoop();
</script>
</body>
</html>